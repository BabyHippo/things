module.exports={hook:function(d,b,a){if(arguments.length===1&&typeof d==="object"){for(var c in d){this.hook(c,d[c])}return}if(!a){a=b}var h=this.prototype||this,g=h._pres=h._pres||{},f=h._posts=h._posts||{};g[d]=g[d]||[];f[d]=f[d]||[];function e(){}h[d]=function(){var q=this,p=this._pres[d],n=this._posts[d],m=0,l=[].slice.call(arguments),o=p.map(function(s,r){var t=function(){if(arguments[0] instanceof Error){return a(arguments[0])}if(m){if(arguments.length){l=[].slice.call(arguments,2)}s.apply(q,[o[r+1]||j,k].concat(l))}else{if(arguments.length){l=[].slice.call(arguments)}s.apply(q,[o[r+1]||i].concat(l))}};if(t.isAsync=s.isAsync){m++}return t});function j(){if(arguments[0] instanceof Error){a(arguments[0])}}function i(){if(arguments[0] instanceof Error){return a(arguments[0])}if(arguments.length){l=[].slice.call(arguments)}b.apply(q,l);var r=n.map(function(t,s){var u=function(){if(arguments[0] instanceof Error){return a(arguments[0])}if(arguments.length){l=[].slice.call(arguments)}t.apply(q,[r[s+1]||e].concat(l))};return u});if(r.length){r[0]()}}if(m){complete=m;function k(){if(arguments[0] instanceof Error){return a(arguments[0])}--complete||i.call(this)}}(o[0]||i)()};return this},pre:function(c,a,b){var e=this.prototype,d=e._pres=e._pres||{};if(a.isAsync=b){this.prototype[c].numAsyncPres++}(d[c]=d[c]||[]).push(a);return this},post:function(c,a,b){var e=this.prototype,d=e._posts=e._posts||{};(d[c]=d[c]||[]).push(a);return this}};