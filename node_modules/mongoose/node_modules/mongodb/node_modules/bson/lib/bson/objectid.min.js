if(typeof window==="undefined"){var BinaryParser=require("./binary_parser").BinaryParser}var MACHINE_ID=parseInt(Math.random()*16777215,10);var checkForHexRegExp=new RegExp("^[0-9a-fA-F]{24}$");var ObjectID=function ObjectID(c,b){if(!(this instanceof ObjectID)){return new ObjectID(c,b)}this._bsontype="ObjectID";var a=null;if(c!=null&&"number"!=typeof c&&(c.length!=12&&c.length!=24)){throw new Error("Argument passed in must be a single String of 12 bytes or a string of 24 hex characters")}if(c==null||typeof c=="number"){this.id=this.generate(c)}else{if(c!=null&&c.length===12){this.id=c}else{if(checkForHexRegExp.test(c)){return ObjectID.createFromHexString(c)}}}if(ObjectID.cacheHexString){this.__id=this.toHexString()}};var ObjectId=ObjectID;ObjectID.prototype.toHexString=function(){if(ObjectID.cacheHexString&&this.__id){return this.__id}var a="",d,e;for(var b=0,c=this.id.length;b<c;b++){e=BinaryParser.toByte(this.id[b]);d=e<=15?"0"+e.toString(16):e.toString(16);a=a+d}if(ObjectID.cacheHexString){this.__id=a}return a};ObjectID.prototype.get_inc=function(){return ObjectID.index=(ObjectID.index+1)%16777215};ObjectID.prototype.getInc=function(){return this.get_inc()};ObjectID.prototype.generate=function(d){if("number"==typeof d){var e=BinaryParser.encodeInt(d,32,true,true);var b=BinaryParser.encodeInt(MACHINE_ID,24,false);var c=BinaryParser.fromShort(typeof process==="undefined"?Math.floor(Math.random()*100000):process.pid);var a=BinaryParser.encodeInt(this.get_inc(),24,false,true)}else{var f=parseInt(Date.now()/1000,10);var e=BinaryParser.encodeInt(f,32,true,true);var b=BinaryParser.encodeInt(MACHINE_ID,24,false);var c=BinaryParser.fromShort(typeof process==="undefined"?Math.floor(Math.random()*100000):process.pid);var a=BinaryParser.encodeInt(this.get_inc(),24,false,true)}return e+b+c+a};ObjectID.prototype.toString=function(){return this.toHexString()};ObjectID.prototype.inspect=ObjectID.prototype.toString;ObjectID.prototype.toJSON=function(){return this.toHexString()};ObjectID.prototype.equals=function equals(b){var a=(b instanceof ObjectID||b.toHexString)?b.id:ObjectID.createFromHexString(b).id;return this.id===a};ObjectID.prototype.getTimestamp=function(){var a=new Date();a.setTime(Math.floor(BinaryParser.decodeInt(this.id.substring(0,4),32,true,true))*1000);return a};ObjectID.index=0;ObjectID.createPk=function createPk(){return new ObjectID()};ObjectID.createFromTime=function createFromTime(b){var a=BinaryParser.encodeInt(b,32,true,true)+BinaryParser.encodeInt(0,64,true,true);return new ObjectID(a)};ObjectID.createFromHexString=function createFromHexString(a){if(typeof a==="undefined"||a!=null&&a.length!=24){throw new Error("Argument passed in must be a single String of 12 bytes or a string of 24 hex characters")}var c=a.length;if(c>12*2){throw new Error("Id cannot be longer than 12 bytes")}var e="",f,d;for(var b=0;b<c;b+=2){f=a.substr(b,2);d=parseInt(f,16);e+=BinaryParser.fromByte(d)}return new ObjectID(e,a)};Object.defineProperty(ObjectID.prototype,"generationTime",{enumerable:true,get:function(){return Math.floor(BinaryParser.decodeInt(this.id.substring(0,4),32,true,true))},set:function(a){var a=BinaryParser.encodeInt(a,32,true,true);this.id=a+this.id.substr(4);this.toHexString()}});if(typeof window==="undefined"){exports.ObjectID=ObjectID;exports.ObjectId=ObjectID};