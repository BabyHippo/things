var BaseCommand=require("./base_command").BaseCommand,inherits=require("util").inherits;var DeleteCommand=exports.DeleteCommand=function(b,a,g,d){BaseCommand.call(this);var e=g;if(Buffer.isBuffer(e)){var f=e[0]|e[1]<<8|e[2]<<16|e[3]<<24;if(f!=e.length){var c=new Error("delete raw message size does not match message header size ["+e.length+"] != ["+f+"]");c.name="MongoError";throw c}}this.flags=d;this.collectionName=a;this.selector=g;this.db=b};inherits(DeleteCommand,BaseCommand);DeleteCommand.OP_DELETE=2006;DeleteCommand.prototype.toBinary=function(){var d=4+Buffer.byteLength(this.collectionName)+1+4+this.db.bson.calculateObjectSize(this.selector,false,true)+(4*4);var b=0;var a=new Buffer(d);a[b+3]=(d>>24)&255;a[b+2]=(d>>16)&255;a[b+1]=(d>>8)&255;a[b]=d&255;b=b+4;a[b+3]=(this.requestId>>24)&255;a[b+2]=(this.requestId>>16)&255;a[b+1]=(this.requestId>>8)&255;a[b]=this.requestId&255;b=b+4;a[b++]=0;a[b++]=0;a[b++]=0;a[b++]=0;a[b+3]=(DeleteCommand.OP_DELETE>>24)&255;a[b+2]=(DeleteCommand.OP_DELETE>>16)&255;a[b+1]=(DeleteCommand.OP_DELETE>>8)&255;a[b]=DeleteCommand.OP_DELETE&255;b=b+4;a[b++]=0;a[b++]=0;a[b++]=0;a[b++]=0;b=b+a.write(this.collectionName,b,"utf8")+1;a[b-1]=0;a[b+3]=(this.flags>>24)&255;a[b+2]=(this.flags>>16)&255;a[b+1]=(this.flags>>8)&255;a[b]=this.flags&255;b=b+4;var c=0;if(Buffer.isBuffer(this.selector)){c=this.selector.length;this.selector.copy(a,b)}else{c=this.db.bson.serializeWithBufferAndIndex(this.selector,this.checkKeys,a,b)-b+1}a[b+3]=(c>>24)&255;a[b+2]=(c>>16)&255;a[b+1]=(c>>8)&255;a[b]=c&255;b=b+c;a[b-1]=0;return a};